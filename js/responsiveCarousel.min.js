!function(a,b,c){"use strict";var d=0;a.widget("ri.responsiveCarousel",{options:{arrowLeft:".arrow-left span",arrowRight:".arrow-right span",mask:".slider-mask",target:"ul",unitElement:"li",unitWidth:"inherit",responsiveUnitSize:null,onRedraw:null,ondragstart:null,ondragend:null,dragEvents:!1,easing:"linear",speed:400,slideSpeed:2500,step:-1,responsiveStep:null,onShift:null,cssAnimations:Modernizr.csstransitions,nudgeThreshold:10,infinite:!0,delta:1,dragVertical:!1,dragPreventDefault:!1,lazyload:!1},_getPrefix:function(a){for(var b=["Moz","Webkit","Khtml","0","ms"],d=c.createElement("div"),e=a.charAt(0).toUpperCase()+a.slice(1),f="",g=b.length;g>-1;)void 0!==d.style[b[g]+e]&&(f=b[g]),g-=1;return f=d.style[a]?a.toLowerCase():"-"+f.toLowerCase()+"-"},_round:function(a){return("compute"===this.options.unitWidth||"inherit"===this.options.unitWidth||"integer"===this.options.unitWidth)&&(a=Math.round(a/this.internal.unitWidth)*this.internal.unitWidth),a},_animate:function(c,e,f,g){var n,h=this.options,i=this.internal,j=i.prefix+"transition",k=this._round(Math.floor(c.position().left)),l=e.left,m=k+l,o=function(a){c.css(a)},p=function(){var e=a('<div class="redraw-'+d+'"> </div>');e.appendTo(c),e.hide(),e.get(0).offsetHeight,e.show(),b.setTimeout(function(){e.remove()},1)};c.css(j,""),p(),h.infinite===!0&&void 0!==l&&(k>l?(n=-1*i.unitWidth*(i.numUnits-i.numVisibleUnits),k===n&&(c.css("left",0),e.left=-i.unitWidth)):l>k&&0===k&&(n=-1*Math.floor(c.find(".clone:first").position().left),c.css("left",n),e.left=n+m)),b.setTimeout(function(){h.cssAnimations?(c.css(j,"left "+f/1e3+"s "+h.easing),o(e),b.setTimeout(function(){c.css(j,""),a.isFunction(g)&&g()},f)):c.animate(e,f,function(){a.isFunction(g)&&g()})},1)},_requestAnimationFrameShim:function(){var d,a=0,c=["ms","moz","webkit","o"];if(!b.requestAnimationFrame||!b.cancelAnimationFrame){for(d=0;d<c.length&&!b.requestAnimationFrame;d+=1)b.requestAnimationFrame=b[c[d]+"RequestAnimationFrame"],b.cancelAnimationFrame=b[c[d]+"CancelAnimationFrame"]||b[c[d]+"CancelRequestAnimationFrame"];b.requestAnimationFrame||(b.requestAnimationFrame=function(c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=b.setTimeout(function(){c(d+e)},e);return a=d+e,f}),b.cancelAnimationFrame||(b.cancelAnimationFrame=function(a){clearTimeout(a)})}},_setTargetWidth:function(){function g(c){var d,e=a(c);e.css("width",""),d=Math.ceil(e.width())+1,e.width(d),b.targetWidth=b.targetWidth+d,e.data("responsiveCarousel",{width:d,top:Math.floor(e.position().top),right:Math.floor(e.position().left)+e.width(),bottom:Math.floor(e.position().top)+e.height(),left:Math.floor(e.position().left)})}var d,f,b=this.internal,c=this.options,e=a(c.unitElement);if(b.numUnits=a(c.unitElement).length,d=b.numUnits,f=d,"individual"===c.unitWidth)for(b.targetWidth=0;f--;)g(e[f]);else b.targetWidth=b.numUnits*b.unitWidth;a(c.target).width(b.targetWidth),b.targetHeight=a(c.target).height(),b.maskWidth=a(c.mask).width(),b.maskHeight=a(c.mask).height()},_setArrowVisibility:function(){var h,b=this.options,c=this.internal,d=a(b.target),e=a(b.arrowLeft),f=a(b.arrowRight),g=0,i=c.maskWidth,j=this._round(Math.floor(d.position().left)),k=c.targetWidth+j;if(f.length&&(b.infinite!==!0&&i>=k?(f.addClass("disabled"),c.isArrowBeingClicked===!0&&this._clearInterval(),c.arrowRightVisible=c.isArrowBeingClicked=!1):(f.removeClass("disabled"),c.arrowRightVisible=!0)),e.length&&(b.infinite!==!0&&j>=g?(e.addClass("disabled"),c.isArrowBeingClicked===!0&&this._clearInterval(),c.arrowLeftVisible=c.isArrowBeingClicked=!1):(e.removeClass("disabled"),c.arrowLeftVisible=!0)),"individual"!==b.unitWidth&&(c.currentSlide=a(b.unitElement).eq([Math.abs(j/c.unitWidth)]).data("slide"),h=c.currentSlide),a.isFunction(b.onShift))"number"==typeof h&&b.onShift(h);else if(null!==b.onShift)throw new Error("The onShift option must be a function or null if not in use.")},_clearInterval:function(){var a=this.internal;"number"==typeof a.timer&&(a.isArrowBeingClicked=!1,b.clearInterval(a.timer))},_doArrowBeingClicked:function(b){var h,i,k,l,m,n,c=this,d=this.internal,e=this.options,f=a(e.target),g=Math.floor(f.position().left),j=e.speed,o=0,q=d.currentSlide;if(d.busy!==!0){if("individual"===e.unitWidth)if("right"===b)if("right"===d.lastArrowClicked)q<d.numUnits-1&&(q+=1,m=a(e.unitElement).eq(q).data("responsiveCarousel"),h=g-m.width,d.currentSlide=q);else for(d.lastArrowClicked="right",l=-1*g+d.maskWidth,n=d.numUnits;n>q;){if(m=a(e.unitElement).eq(q).data("responsiveCarousel"),l>=m.left&&l<=m.right){h=g-(m.right-l),j=e.speed-e.speed*((l-m.left)/m.width),d.currentSlide=q;break}o+=m.width,q+=1}else{if("left"!==b)throw new Error("unknown direction");if("left"===d.lastArrowClicked)q>0&&(q-=1,m=a(e.unitElement).eq(q).data("responsiveCarousel"),h=g+m.width,d.currentSlide=q);else if(d.lastArrowClicked="left",a(e.unitElement).eq(d.currentSlide).length)for(k=Math.abs(g);q>=0;){if(m=a(e.unitElement).eq(q).data("responsiveCarousel"),k>=m.left&&k<=m.right){h=g+m.width,m.right>k&&(h-=m.right+g),j=e.speed*((k-m.left)/m.width),d.currentSlide=q;break}o+=m.width,q-=1}}else if("left"===b)h=g+d.unitWidth;else{if("right"!==b)throw new Error("unknown direction");h=g-d.unitWidth}h=this._round(h),i=d.maskWidth<d.targetWidth?d.maskWidth-d.targetWidth:0,h>0&&(h=0),i>h&&(h=i),j=j>=100?j:100,d.busy=!0,this._animate(f,{left:h},j,function(){c._setArrowVisibility("_doArrowBeingClicked"),d.busy=!1})}},_setArrowEvents:function(){var c=this,d=this.options,e=this.internal,f=a(d.arrowLeft),g=a(d.arrowRight),h="",i="";f.on("click"+this.instanceId,function(a){a.preventDefault()}),g.on("click"+this.instanceId,function(a){a.preventDefault()}),d.dragEvents===!0?(h="mousedown"+this.instanceId+" touchstart"+this.instanceId+" gesturestart"+this.instanceId+" gesturechange"+this.instanceId,i="mouseup"+this.instanceId+" mouseout"+this.instanceId+" mouseleave"+this.instanceId+" touchend"+this.instanceId+" touchleave"+this.instanceId+" gestureend"+this.instanceId):(h="mousedown"+this.instanceId,i="mouseup"+this.instanceId+" mouseout"+this.instanceId+" mouseleave"+this.instanceId),f.on(h,function(a){!0===e.ios6Device&&(e.busy=!1),a.preventDefault(),a.stopPropagation(),e.busy!==!1||f.hasClass("disabled")||(e.isArrowBeingClicked=e.firstMouseClick=!0,e.timer=b.setInterval(function(){c._doArrowBeingClicked("left")},10),e.slideTimer&&(b.clearInterval(e.slideTimer),e.slideShowActive=!1))}),g.on(h,function(a){!0===e.ios6Device&&(e.busy=!1),a.preventDefault(),a.stopPropagation(),e.busy!==!1||g.hasClass("disabled")||(e.isArrowBeingClicked=e.firstMouseClick=!0,e.timer=b.setInterval(function(){c._doArrowBeingClicked("right")},10),e.slideTimer&&(b.clearInterval(e.slideTimer),e.slideShowActive=!1))}),a.each([f,g],function(){a(this).on(i,function(){e.isArrowBeingClicked===!0&&c._clearInterval()})}),a(b).on("scroll"+this.instanceId,function(){"individual"!==d.unitWidth&&(b.clearTimeout(e.scrollTimer),e.scrollTimer=b.setTimeout(function(){c._clearInterval()},100))}),a(b).on(" resize"+this.instanceId+" onorientationchange"+this.instanceId,function(){b.clearTimeout(e.resizeTimer),e.resizeTimer=b.setTimeout(function(){c._setTargetWidth(),c._clearInterval()},100)})},_setUnitWidth:function(){var c,d,l,m,n,e=this,f=this.internal,g=this.options,h=a(g.target),i=a(this.element),j=a(g.unitElement+":not(.clone)"),k=j.eq(0),o=function(){f.unitWidth=k.width()},p=function(){if(f.maskWidth=a(g.mask).width(),d=g.responsiveUnitSize(i,f,g),"number"!=typeof d||1>d)throw new Error("The responsiveUnitSize callback must return a whole number greater than 0");c=f.maskWidth/d,c=Math.floor(c),a(g.unitElement).css("width",c),g.infinite===!0&&d>0&&d!==f.numVisibleUnits&&(f.numVisibleUnits=d,h.find(".clone").remove(),j.slice(0,f.numVisibleUnits).clone(!0).addClass("clone").appendTo(h)),f.unitWidth=c,f.numVisibleUnits=d},q=function(c){a(c).one("load"+e.instanceId,function(){(h.is(":hidden")===!1||h.is(":visible")===!0)&&(b.clearTimeout(f.imageLoadTimer),f.imageLoadTimer=b.setTimeout(function(){a.isFunction(g.responsiveUnitSize)&&p(),o(),e._setTargetWidth(),e._setArrowVisibility(),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g)},400))})};if("inherit"===g.unitWidth)o(),h.find("img").one("load"+e.instanceId,function(){o(),e._setTargetWidth(),e._setArrowVisibility(),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g)});else if("individual"===g.unitWidth)(h.is(":hidden")===!1||h.is(":visible")===!0)&&(e._setTargetWidth(),e._setArrowVisibility()),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g),h.find("img").one("load"+e.instanceId,function(){(h.is(":hidden")===!1||h.is(":visible")===!0)&&(b.clearTimeout(f.imageLoadTimer),f.imageLoadTimer=b.setTimeout(function(){e._setTargetWidth(),e._setArrowVisibility(),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g)}))}),a(b).on("resize"+e.instanceId,function(){var c=f.currentSlide;clearTimeout(f.setWidthTimer),f.setWidthTimer=setTimeout(function(){var d,j,k,l;(h.is(":hidden")===!1||h.is(":visible")===!0)&&(e._setTargetWidth(),j=a(g.unitElement).eq(c).data("responsiveCarousel"),"right"===f.lastArrowClicked?d=f.maskWidth-j.right:"left"===f.lastArrowClicked&&c>0?d=-1*a(g.unitElement).eq(c-1).data("responsiveCarousel").right:(d=0,f.currentSlide=0),l=f.left+d,k=f.maskWidth-f.targetWidth,k>l&&(d=k,f.currentSlide=f.numUnits-1),l>0&&(d=0,f.currentSlide=0),h.css({left:d}),b.requestAnimationFrame(function(){e._setArrowVisibility("_setUnitWidth individual resize"),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g)}))},400)});else if("compute"===g.unitWidth){for(o(),a.isFunction(g.responsiveUnitSize)&&(p(),o()),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g),m=h.find("img"),n=m.length,l=0;n>l;++l)q(m[l]);a(b).on("resize"+e.instanceId,function(){var c=f.currentSlide;b.clearTimeout(f.setWidthTimer),(h.is(":hidden")===!1||h.is(":visible")===!0)&&(f.setWidthTimer=setTimeout(function(){var b,d=-1*f.numUnits*f.unitWidth+f.maskWidth;a.isFunction(g.responsiveUnitSize)&&(p(),o()),o(),e._setTargetWidth(),b=-1*c*f.unitWidth,d>b&&(b=f.maskWidth-f.targetWidth),h.css({left:b}),e._setArrowVisibility(),a.isFunction(g.onRedraw)&&g.onRedraw(i,f,g)},500))})}else f.unitWidth=g.unitWidth},_dragEvents:function(){var i,c=this,d=this.options,e=this.internal,f=a(d.target),g=a(d.mask),h=f,j=new Hammer(g.get(0),{prevent_default:d.dragPreventDefault,css_hacks:!0,drag:!0,drag_vertical:d.dragVertical,drag_horizontal:!0,drag_min_distance:0,swipe:!1,transform:!1,tap:!1,tap_double:!1,hold:!1}),k={},l=function(){var a={top:parseInt(h.css("top"),10),left:parseInt(h.css("left"),10)};return a},m=function(a){var f,g,b=d.delta,c=a.direction;!0!==e.isArrowBeingClicked&&(("up"===c||"left"===c)&&(a.distance=-1*a.distance),f=k.left+a.distance*b,g=Math.abs(e.scrollStart.left-f),"individual"===d.unitWidth?g>d.nudgeThreshold&&(e.nudgeDirection="up"===a.direction||"left"===a.direction?"left":"right"):e.nudgeDirection=g>d.nudgeThreshold&&g<e.unitWidth/2?"up"===c||"left"===c?"left":"right":g<=d.nudgeThreshold?"abort":null,d.infinite===!0&&(i>=f&&(f=a.distance*b,e.scrollStart.left=0),f>=0&&(f=i+a.distance*b,e.scrollStart.left=i)),e.left=f,h.css("left",f))};e.touchObject=j,j.ondragstart=function(){return c.stopSlideShow(),b.cancelAnimationFrame(e.dragTimer),"individual"===d.unitWidth||(i=-1*e.unitWidth*(e.numUnits-e.numVisibleUnits)),!0===e.isArrowBeingClicked||!0===e.busy?{}:(e.busy=!0===e.ios6Device?!1:!0,k=l(),k.time=(new Date).getTime(),e.scrollStart=k,a.isFunction(d.ondragstart)&&d.ondragstart(d,e),void 0)},j.ondrag=function(a){e.dragTimer=b.requestAnimationFrame(function(){m(a)})},j.ondragend=function(){b.cancelAnimationFrame(e.dragTimer),f.stop(!0,!1),b.requestAnimationFrame(function(){c._animate(f,{left:c.computeAdjust(f)},d.speed,function(){c._setArrowVisibility(),e.busy=!1,a.isFunction(d.ondragend)&&d.ondragend(d,e)})})}},_create:function(){d+=1;var b=this.options,c=a(this.element),e=a(b.target);this.instanceId=".carousel_"+d.toString(10),this.internal={busy:!1,currentSlide:0,left:0,targetWidth:0,targetHeight:0,maskWidth:0,maskHeight:0,unitWidth:0,targetBackupCopy:null,isArrowBeingClicked:!1,lastArrowClicked:null,arrowLeftVisible:!0,arrowRightVisible:!0,targetLeft:0,timer:null,dragTimer:null,dragEndTimer:null,scrollTimer:null,resizeTimer:null,firstMouseClick:!1,prefix:null,slideShowActive:!1,slideTimer:null,slideBumped:!1,nudgeDirection:null,infinite:!1,numUnits:null,numVisibleUnits:null,scrollStart:0,touchObject:null,setWidthTimer:null,lazyloaded:!1,ios6Device:!1},this.internal.backup=e.clone(!0,!0),this.options.cssAnimations&&(this.internal.prefix=this._getPrefix("transition")),/(iPhone|iPod|iPad)/i.test(navigator.userAgent)&&/OS 6_/i.test(navigator.userAgent)&&(this.internal.ios6Device=!0),this._requestAnimationFrameShim(),e.css({position:"relative",left:0}),e.addClass("instance-"+d),a(b.unitElement).each(function(b){a(this).attr({"data-slide":b})}),b.dragEvents===!0&&this._dragEvents(),this._setArrowEvents(),b.lazyload===!0&&a(b.target).find("img.lazy-slider").lazyload({effect:"fadeIn",skip_invisible:!1}),(e.is(":visible")===!0||e.is(":hidden")===!1)&&(this._setUnitWidth(),this._setTargetWidth(),this._setArrowVisibility(),b.lazyload===!0&&this._lazyLoad()),a.isFunction(b.onRedraw)&&b.onRedraw(c,this.internal,b)},_lazyLoad:function(){function h(b){a(b).trigger("appear")}function i(){var b,d=a(e.unitElement);for(f=c.currentSlide;g>f;f+=1)b=d.eq(f),b.length&&b.find('img.lazy-slider:not([loaded="true"])').each(function(){h(this)})}function j(){var b=0;a(e.target).find('img.lazy-slider:not([loaded="true"])').each(function(){a(this).trigger("appear"),b+=1})}function k(){var c=a(e.target).offset().top,d=a(b).scrollTop()+a(b).height()+600,f=!1;return d>c&&(j(),f=!0),f}var f,c=this.internal,d=this.instanceId,e=this.options,g=c.currentSlide+2*c.numVisibleUnits;!0===a.browser.msie&&"8."===a.browser.version.substring(0,2)?j():!1===c.lazyloaded&&(i(),a(b).on("load",function(){i()}),e.dragEvents===!0?!1===k()&&a(b).on("scroll.tempevent"+d,function(){!0===k()&&a(b).unbind("scroll.tempevent"+d)}):a.each([a(e.target),a(e.arrowLeft),a(e.arrowRight)],function(){var a=this;a.on("mouseover.tempevent",function(){j(),a.unbind(".tempevent")})}),c.lazyloaded=!0)},redraw:function(){var b=this,c=this.internal,d=this.options,e=a(this.element);(a(d.target).is(":visible")||a(d.target).not(":hidden"))&&(void 0===this.unitWidth&&this._setUnitWidth(),this._setTargetWidth(),this._setArrowVisibility(),a.isFunction(this.options.onRedraw)&&b.options.onRedraw(e,c,d),d.lazyload===!0&&b._lazyLoad())},getCurrentSlide:function(){return this.internal.currentSlide},goToSlide:function(b,c){var h,d=this,e=this.internal,f=this.options,g=a(f.target);c=void 0!==c?c:!0,g.not(":hidden")&&(void 0===this.unitWidth&&this._setUnitWidth(),h="individual"===f.unitWidth?a(f.unitElement).eq(b).data("responsiveCarousel").left:-1*b*e.unitWidth,e.busy=!0,c===!0?this._animate(g,{left:h},f.speed,function(){e.busy=!1,d._setArrowVisibility("goto slide")}):g.css("left",h))},toggleSlideShow:function(){var a=this.internal;!1===a.slideShowActive?this.startSlideShow():this.stopSlideShow()},_step:function(b){var c=this,d=this.internal,e=this.options,f=a(e.target),g=d.maskWidth,h=this._round(Math.floor(f.position().left)),i=h+b*d.unitWidth,j=h+d.targetWidth,k=j+b*d.unitWidth,l=i;d.slideBumped===!1?e.infinite===!1&&(g>=k&&(l=i+g-k,d.slideBumped="left"),i>=0&&(d.slideBumped="right",l=0)):("left"===d.slideBumped&&(l=0),"right"===d.slideBumped&&(l=h+g-j),d.slideBumped=!1),d.busy=!0,this._animate(f,{left:l},e.speed,function(){d.busy=!1,c._setArrowVisibility("_step")})},startSlideShow:function(){var a=this,c=this.internal,d=this.options;!1===c.slideShowActive&&(c.slideShowActive=!0,c.slideTimer=b.setInterval(function(){a._step(d.step)},d.slideSpeed))},stopSlideShow:function(){var a=this.internal;!0===a.slideShowActive&&(a.slideShowActive=!1,b.clearInterval(a.slideTimer))},_destroy:function(){var e=a(this.options.target),f=a(this.options.mask);b.clearTimeout(this.internal.setWidthTimer),b.clearInterval(this.internal.slideTimer),b.clearTimeout(this.internal.scrollTimer),b.clearTimeout(this.internal.resizeTimer),b.cancelAnimationFrame(this.internal.dragTimer),a(b).unbind(this.instanceId),a(c).unbind(this.instanceId),a(this.options.arrowLeft).unbind(this.instanceId),a(this.options.arrowRight).unbind(this.instanceId),e.removeClass("instance-"+d),e.find("img").unbind(this.instanceId),null!==this.internal.touchObject&&this.internal.touchObject.destroy(),f.css({"-webkit-user-select":"","-webkit-user-drag":"","-webkit-tap-highlight-color":""}),e.replaceWith(this.internal.backup)},computeAdjust:function(b){function o(){var b,e,g,h=0,j=c.currentSlide,k=a(d.unitElement);for(b=-1*f+c.maskWidth,e=c.numUnits;e>j;){if(g=k.eq(j).data("responsiveCarousel"),b>=g.left&&b<=g.right)return i=f-(g.right-b),c.currentSlide=j,void 0;h+=g.width,j+=1}i=f}function p(){var b,e,g=0,h=c.currentSlide,j=a(d.unitElement);for(b=Math.abs(f);h>=0;){if(e=j.eq(h).data("responsiveCarousel"),b>=e.left&&b<=e.right)return i=f+e.width,e.right>b&&(i-=e.right+f),c.currentSlide=h,void 0;g+=e.width,h-=1}i=f}var g,c=this.internal,d=this.options,e=c.scrollStart.left,f=b.position().left,h=c.maskWidth,i=0,j=c.nudgeDirection,k=c.unitWidth;return"individual"===d.unitWidth?null!==j&&("left"===j&&o(),"right"===j&&p(),"abort"===j&&(i=f),f=i,c.nudgeDirection=null):null!==j&&("left"===j&&(i=e-k),"right"===j&&(i=e+k),"abort"===j&&(i=f),f=i,c.nudgeDirection=null),g=f+c.targetWidth,h>g&&(i=f+h-g,f=i),f>0&&(f=i=0),"individual"!==d.unitWidth&&(i=this._round(f)),isNaN(i)===!0&&(i=0),i},getNumVisibleUnits:function(){return this.internal.numVisibleUnits}})}(jQuery,window,document);